# Use the official node image as the base image
FROM node:16-alpine as build-stage
# Đặt thư mục làm việc
WORKDIR /vue-basic 
# Sao chép các tệp package.json và package-lock.json cần thiết
COPY /vue-basic/package*.json ./
# Cài đặt thư viện
RUN npm install
# Sao chép mã nguồn ứng dụng vào container
COPY ./vue-basic .
# Build ứng dụng Vue.js cho môi trường production
RUN npm run build
# Sử dụng image Nginx
FROM nginx:stable-alpine as production-stage
# Sao chép các tệp build từ giai đoạn build-stage
COPY --from=build-stage /vue-basic/dist /usr/share/nginx/html
# Sao chép file cấu hình Nginx tùy chỉnh (nếu cần)
COPY /nginx/nginx.conf /etc/nginx/nginx.conf
COPY /nginx/default.conf /etc/nginx/conf.d/default.conf
# Sao chép tập lệnh khởi động
COPY start.sh /start.sh
# Cấp quyền thực thi cho tập lệnh khởi động
RUN chmod +x /start.sh
# Mở cổng 80 để Nginx phục vụ ứng dụng qua HTTP.
EXPOSE 80
# Thiết lập start.sh làm lệnh sẽ chạy khi container khởi động.
ENTRYPOINT ["/start.sh"]
